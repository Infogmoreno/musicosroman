<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-troika-text/dist/aframe-troika-text.min.js"></script>
    <script>
      /* global AFRAME */
      AFRAME.registerComponent("play-on-click", {
        init: function () {
          this.onClick = this.onClick.bind(this);
        },
        play: function () {
          window.addEventListener("click", this.onClick);
        },
        pause: function () {
          window.removeEventListener("click", this.onClick);
        },
        onClick: function (evt) {
          var videoEl = this.el.getAttribute("material").src;
          
          if (!videoEl) {
            return;
          }
          this.el.object3D.visible = true;
          videoEl.play();
          
        },
      });

    </script>

<style>

.mainUI
{
	border: 0px solid pink; 
	position: fixed; 
	top: 0px;  
	width:99%; 
	height:99%; 
	z-index: 1; 
	pointer-events: none; 
}

.regionUI
{
	border: none;
	position: absolute; 
	display: flex;
	flex-direction: row;
	pointer-events: none;
}

.buttonUI
{
	border: none;
	display: flex;
	flex-direction: row;
	justify-content: center;
	pointer-events: auto;	
}
.boton {
  border: none;
  border-radius: 5px;
  background-color: rgb(158, 158, 130);
  padding: 8px;
  margin: 8px;
  pointer-events: auto;
  opacity: 1;
}
.boton:hover {
  opacity: 0.6;
  color: white
}
#credito {
position: absolute;
right: -15%;
bottom: -18%;	
width: auto;	
font-size: 8px;	
font-family: Roboto;
color: white;
opacity: 0.6;	
}	

</style>
  </head>
  <body>
    <a-scene      
      color-space="sRGB"
      renderer="colorManagement: true, physicallyCorrectLights; sortTransparentObjects: true"
      webxr="requiredFeatures: hit-test,local-floor;
                optionalFeatures: dom-overlay,unbounded;
                overlayElement: #uiDiv;"
      ar-hit-test="target:#video;"
      
    >
      <a-assets>        
        <video
          id="video_musicos"
          src="assets/Musicos_roman_instrum_conmusica.webm"
          crossorigin="anonymous"
          preload="auto"
          loop="false"
        ></video>
        <audio 
         id="loc_tibiac" 
         src="assets/Tibiac_voz_mujer2.wav"         
         preload="auto"
          ></audio>
          <audio 
         id="loc_timpanun" 
         src="assets/Timpanum_voz_mujer.wav"         
         preload="auto"
          ></audio>
        <img 
         id="tibiactxt" 
         src="assets/Tibiac_txt.png"         
          >
        <img 
         id="timpanumtxt" 
         src="assets/Timpanum_txt.png"         
          >
        <a-asset-item 
        id="panelinfo"
        src="assets/Panel_informacion.glb"
        >          
        </a-asset-item>
        <a-asset-item
        id="titular"
        src="assets/Titular.glb"
        ></a-asset-item>  
      </a-assets>
      
        
      <a-entity 
         id="video" 
         position="0 1 0" 
         class="click">
        
        <a-video
          class="click"
          height="0.6"
          width="0.6"
          material="src: #video_musicos"
          position="0 0 -0.65"
          play-on-click
        >
        </a-video>
       <a-image
        id="tibiac_rotulo"
        src="#tibiactxt"
        shader="flat"
        position="0.02 0.2 -0.5"
        width="1"
        height="0.5"
        scale="0.1 0.1 0"
        visible="false">
        </a-image>
        <a-image
        id="timpanum_rotulo"
        src="#timpanumtxt"
        shader="flat"
        position="0.2 0.17 -0.5"
        width="1"
        height="0.5"
        scale="0.1 0.09 0"
        visible="false">
        </a-image> 
       <a-entity
       id="infopanel"
       gltf-model="#panelinfo"
       position="0.75 0.01 -0.85"
       scale="0.18 0.18 1"
       visible="false"
       ></a-entity>
       
       <a-camera
        position="0 0 0"
        look-controls
        wasd-controls="acceleration: 10"
        cursor="rayOrigin: entity"
        raycaster="objects: .click"
      >
       <a-entity
       id="titular_instrum" 
       troika-text="value: INSTRUMENTOS MUSICALES ANTIGUA ROMA; color: white; fontSize: 0.025"
       position="-0.02 0.487 -0.64"       
       visible="false"       
       ></a-entity> 
      <a-entity id="tibiac_loc" sound="src: #loc_tibiac" position="0 0 0"></a-entity> 
      <a-entity id="timpanum_loc" sound="src: #loc_timpanun" position="0 0 0"></a-entity>     
    </a-camera>    
    </a-scene>
    
    <div class="mainUI" id="uiDiv" oncontextmenu="return false;">
	
	<!-- bottom-right -->
	<div class="regionUI baseColor" style="bottom: 9%; right: 12%;">
		<div class="buttonUI">
        <button id="btn_tibiac" class="boton">Tibiac</button>
	    	<button id="btn_timpanum" class="boton">Timpanum</button>
        <button id="btn_detalles" class="boton">Detalles</button>
        <p id="credito">JoseMar√≠a Moreno</p>        
	    </div>    	
	</div>
</div>

<script>
  
  const btn_tibiac = document.querySelector ("#btn_tibiac");
  const btn_timpanum = document.querySelector ("#btn_timpanum");
  const btn_detalles = document.querySelector ("#btn_detalles");
  const btn_titular = document.querySelector ("#titular_instrum");

  const tibiac_rotulo = document.querySelector ("#tibiac_rotulo");
  const timpanum_rotulo = document.querySelector ("#timpanum_rotulo");
  const infopanel = document.querySelector ("#infopanel");
  const titular_instrum = document.querySelector ("#titular_instrum");


  const tibiac_loc = document.querySelector ("#tibiac_loc");
  const timpanum_loc = document.querySelector ("#timpanum_loc");

  btn_tibiac.addEventListener ("click", function () {
    tibiac_loc.components.sound.playSound();
    timpanum_loc.components.sound.stopSound();
    tibiac_rotulo.setAttribute("visible", true);
    timpanum_rotulo.setAttribute("visible", false);
    infopanel.setAttribute("visible", false);
  });

   btn_timpanum.addEventListener ("click", function () {
    timpanum_loc.components.sound.playSound();
    tibiac_loc.components.sound.stopSound();
    tibiac_rotulo.setAttribute("visible", false);
    timpanum_rotulo.setAttribute("visible", true);
    infopanel.setAttribute("visible", false);
  });

  btn_detalles.addEventListener ("click", function () {
    infopanel.setAttribute("visible", !infopanel.getAttribute("visible"));
    tibiac_rotulo.setAttribute("visible", false);
    timpanum_rotulo.setAttribute("visible", false);
    titular_instrum.setAttribute("visible", !titular_instrum.getAttribute("visible"));
  });
   btn_tibiac.addEventListener("beforexrselect", (e) => {
        e.preventDefault();
      });
   btn_timpanum.addEventListener("beforexrselect", (e) => {
        e.preventDefault();
      }); 
   btn_detalles.addEventListener("beforexrselect", (e) => {
        e.preventDefault();
      });     
</script>
  </body>
</html>
